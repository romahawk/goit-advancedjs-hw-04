{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet lightBoxInstance;\n\nfunction renderGalleryItem({\n  src,\n  originalSrc,\n  description,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${originalSrc}\">\n                <img\n                    class=\"gallery-image\"\n                    src=\"${src}\"\n                    data-source=\"${originalSrc}\"\n                    alt=\"${description}\"\n                    width=360\n                    height=200\n                />\n\n            </a>\n            <ul class='metadata'>\n                <li>\n                    <p class='metadata-heading'>Likes</p>\n                    <p>${likes}</p>\n                </li>\n                <li>\n                    <p class='metadata-heading'>Views</p>\n                    <p>${views}</p>\n                </li>\n                <li>\n                    <p class='metadata-heading'>Comments</p>\n                    <p>${comments}</p>\n                </li>\n                <li>\n                    <p metadata-heading>Downloads</p>\n                    <p>${downloads}</p>\n                </li>\n            </ul>\n        </li>`;\n}\n\nfunction getGalleryHtml(images) {\n  return images\n    .map(\n      ({\n        webformatURL: src,\n        largeImageURL: originalSrc,\n        tags: description,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        renderGalleryItem({\n          src,\n          originalSrc,\n          description,\n          likes,\n          views,\n          comments,\n          downloads,\n        })\n    )\n    .join('');\n}\n\nfunction initLightBox() {\n  lightBoxInstance = new SimpleLightbox('.gallery a');\n\n  lightBoxInstance.refresh();\n}\n\nexport function clearGallery(gallery) {\n  gallery.innerHTML = '';\n}\n\nexport function appendGallery(gallery, images) {\n  const galleryHtml = getGalleryHtml(images);\n  gallery.insertAdjacentHTML('beforeend', galleryHtml);\n  lightBoxInstance.refresh();\n}\n\nexport function initGallery(gallery, images) {\n  const galleryHtml = getGalleryHtml(images);\n  gallery.innerHTML = galleryHtml;\n\n  initLightBox();\n}\n\nexport function hideElement(element) {\n  element.classList.add('hidden');\n}\n\nexport function showElement(element) {\n  element.classList.remove('hidden');\n}\n\nexport function showToast(message, color = 'red') {\n  iziToast.show({\n    message,\n    color,\n    position: 'topRight',\n  });\n}\n","import axios from 'axios';\nimport { showToast } from './render-functions';\n\nexport const DEFAULT_LIMIT = 15;\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\naxios.defaults.params = {\n  key: '51053384-5356fc0331195a75022768729',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: DEFAULT_LIMIT,\n};\n\nexport async function getPictures(query, page = 1) {\n  return await axios\n    .get('/', {\n      params: {\n        q: query,\n        page,\n      },\n    })\n    .catch(error => {\n      console.error(error.message);\n      showToast('Oops! Something went wrong.');\n    });\n}\n","import { getPictures, DEFAULT_LIMIT } from './js/pixabay-api';\nimport {\n  initGallery,\n  appendGallery,\n  clearGallery,\n  hideElement,\n  showElement,\n  showToast,\n} from './js/render-functions';\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('form');\nconst searchInput = document.querySelector('input');\nconst loader = document.querySelector('.loader');\nconst button = document.querySelector('button');\nconst addMoreButton = document.querySelector('.add-more');\n\nlet query;\nlet totalPages = 1;\nlet currentPage = 1;\n\naddMoreButton.addEventListener('click', async () => {\n  hideElement(addMoreButton);\n  showElement(loader);\n\n  const response = await getPictures(query, ++currentPage);\n\n  if (response?.data) {\n    const { hits } = response.data;\n    appendGallery(gallery, hits);\n    scrollGallery();\n    hideElement(loader);\n\n    if (currentPage < totalPages) {\n      showElement(addMoreButton);\n    }\n\n    if (currentPage === totalPages) {\n      showToast(\n        \"We're sorry, but you've reached the end of search results.\",\n        'blue'\n      );\n    }\n  }\n});\n\nfunction scrollGallery() {\n  const item = document.querySelector('.gallery-item');\n\n  if (item) {\n    const { height } = item.getBoundingClientRect();\n\n    window.scrollBy({\n      top: height * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction reset() {\n  hideElement(addMoreButton);\n  totalPages = 1;\n  currentPage = 1;\n}\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  if (!gallery) return;\n\n  const newQuery = searchInput.value;\n\n  if (newQuery !== query) {\n    reset();\n  }\n\n  query = newQuery;\n  searchInput.value = '';\n\n  if (query) {\n    clearGallery(gallery);\n    showElement(loader);\n\n    button.setAttribute('disabled', 'disabled');\n\n    const response = await getPictures(query);\n\n    if (response?.data) {\n      const { hits, totalHits } = response.data;\n      totalPages = Math.ceil(totalHits / DEFAULT_LIMIT);\n\n      if (!hits.length) {\n        showToast(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      } else {\n        initGallery(gallery, hits);\n      }\n    }\n    hideElement(loader);\n    button.removeAttribute('disabled');\n\n    if (totalPages > 1) {\n      showElement(addMoreButton);\n    }\n  }\n});\n"],"names":["lightBoxInstance","renderGalleryItem","src","originalSrc","description","likes","views","comments","downloads","getGalleryHtml","images","initLightBox","SimpleLightbox","clearGallery","gallery","appendGallery","galleryHtml","initGallery","hideElement","element","showElement","showToast","message","color","iziToast","DEFAULT_LIMIT","axios","getPictures","query","page","error","form","searchInput","loader","button","addMoreButton","totalPages","currentPage","response","hits","scrollGallery","item","height","reset","newQuery","totalHits"],"mappings":"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"}